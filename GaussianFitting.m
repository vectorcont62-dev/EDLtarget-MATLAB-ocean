clc; clear; %close all;

% EnergyLevel = [(1:0.2:2.6)'];
% Endurance = [...
%     1.41338E17,	1.70996E17,	1.91553E17,	2.04146E17,	2.39732E17,	6.03692E17, 6.03692E17;	...
%     5.52022E16,	1.50239E17,	2.05605E17,	2.10097E17,	3.26124E17,	4.34857E17,	6.03692E17;...
%     6.08087E15,	4.99264E16,	1.81922E17,	2.23319E17,	3.7046E17,	4.85196E17,	7.06661E17;...
%     6.62435E15,	3.20673E16,	8.56752E16,	1.84213E17,	2.97605E17,	4.03484E17,	6.92798E17;...
%     6.86292E15,	3.02003E16,	4.69993E16,	1.28193E17,	2.67677E17,	3.62188E17,	5.64537E17;...
%     1.00726E16,	2.95576E16,	4.52843E16,	7.73745E16,	2.67097E17,	3.38468E17,	4.9108E17;...
%     1.32434E16,	2.69015E16,	3.68427E16,	5.40013E16,	2.53028E17,	3.64063E17,	4.35422E17;...
%     1.50793E16,	2.5412E16,	2.43179E16,	3.89486E16,	1.32202E17,	3.13714E17,	5.09292E17;...
%     1.27449E16,	2.23037E16,	2.20008E16,	2.93018E16,	4.62785E16,	1.77785E17,	2.57449E17;];

% EnergyLevel = [0.3; (1:0.2:2.6)'];
EnergyLevel = [.8; (1:0.2:2.6)'; 2.8];
Endurance = [0, 0, 0, 0, 0, 0, 0;...
    0, 4.30064E16,	5.6126E16,	6.17145E16,	6.21512E16,	9.67909E16,	1.02156E17;...
    0, 3.54133E16,	4.62754E16,	5.76464E16,	7.17633E16,	1.26679E17,	1.51539E17;...
    0, 2.92929E16,	3.79034E16,	4.78022E16,	8.52553E16,	1.03295E17,	1.262E17;...
    0, 2.2279E16,	3.15781E16,	3.28404E16,	7.03126E16,	7.03541E16,	9.81026E16;...
    0, 1.26767E16,	2.48731E16,	2.19427E16,	5.28983E16,	5.25118E16,	7.264E16;...
    0, 6.61512E15,	1.43743E16,	1.82297E16,	4.99205E16,	6.8827E16,	7.59581E16;...
    0, 7.23662E15,	9.00059E15,	1.47049E16,	7.23395E16,	1.41175E17,	1.66478E17;...
    0, 7.15829E15,	9.5004E15,	1.44371E16,	3.76473E16,	7.51587E16,	1.09608E17;...
    0, 7.56446E15,	1.07344E16,	8.43027E15,	1.64587E16,	1.64587E16,	1.64587E16;...
    0, 0, 0, 0, 0, 0, 0;];

EnergySpan = (0:1e-3:3)';
figure(1); subplot(3,1,1);
plot(EnergyLevel, Endurance(:,2), 'o'); hold on;
G0 = fit(EnergyLevel,Endurance(:,2), 'gauss2');
FittedEndurance0 = feval(G0, EnergySpan);
plot(EnergySpan, FittedEndurance0, '-');

subplot(3,1,2);
plot(EnergyLevel, Endurance(:,5), 'o'); hold on;
G3 = fit(EnergyLevel,Endurance(:,5), 'gauss2');
FittedEndurance3 = feval(G3, EnergySpan);
plot(EnergySpan, FittedEndurance3, '-');

subplot(3,1,3);
plot(EnergyLevel, Endurance(:,7), 'o'); hold on;
G10 = fit(EnergyLevel,Endurance(:,7), 'gauss2');
FittedEndurance10 = feval(G10, EnergySpan);
plot(EnergySpan, FittedEndurance10, '-');
% 
% subplot(2,2,4);
% plot(EnergyLevel, Endurance(:,7), 'o'); hold on;
% G50 = fit(EnergyLevel,Endurance(:,7), 'gauss2');
% FittedEndurance = feval(G50, EnergySpan);
% plot(EnergySpan, FittedEndurance, '-');
